<!DOCTYPE HTML>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>high level bits - Tests running on commit</title>

    <link href="https://fonts.googleapis.com/css?family=Iceland%7CVolkhov" rel="stylesheet" type="text/css">

    <link href="../../awesome/font-awesome-min.css" rel="stylesheet">
    <link href="../../style.css" rel="stylesheet">
    <link href="../../forms.css" rel="stylesheet">

    <link rel="alternate" type="application/atom+xml" title="high level bits" href="../../atom.xml">

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 4.1.6">
      
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  </head>
  <body>
    <div class="main">
      <div class="header">
        <a href="../../">
          <h1>h1ghlevelb1ts</h1>
        </a>
      </div>
      <div class="menu">
        <a href="../../">home</a>
        ·
        <a href="../../archive.html">archive</a>
      </div>
      <div class="content">
        <h2 class="article-header">
  Tests running on commit
</h2>
<div>
  <span class="byline">2015-05-16 by fredrik</span>
  
    <span class="tags">
      
        <a class="one-tag" href="../../tags/git.html" rel="tag"><span class="icon-tag"></span>git</a>
      
        <a class="one-tag" href="../../tags/testing.html" rel="tag"><span class="icon-tag"></span>testing</a>
      
    </span>
  
</div>
<div class="inner-content">

<p>If you are like me you like to have fast running tests and you don’t want failing tests in your repository.
Normally you ensure this with developer discipline and a CI server running stuff when repos get pushed
to the remote git server.</p>

<p>The other day I played with the thought of actually stopping a commit if the specs isn’t running. 
You need to have blindlingly fast tests for this to be practical. Tests hitting the database or being
involved in I/O in general are out of the question here. With git you can put hooks on almost everything.
One place is the <code>pre-commit</code> hook and it is suitable for this purpose. All the hooks are located in the 
<code>.git/hooks</code> folder of the repository. In a new repo there is a bunhc of samples here to give inspiration 
about what is possible to do. The principle is easy. Any hook that returns a non-zero result will 
interrupt the execution of the git command currently running. So for this purpose I just needed to add 
one line of code to the new <code>pre-commit</code> file.</p>

<pre><code>exec rspec spec
</code></pre>

<p>This command returns non-zero when a test is failing so it will stop the commit from proceeding if there
are failing tests.</p>

<p>Suppose you are running java and maven (like me at my current assignment)? Then you are out of luck. Just
waiting for maven to get started is the kind of times we don’t have patience with when comitting code. 
Then we are lucky to have our build server doing it for us.</p>

</div>

      </div>
      <div class="footer">
        high level bits was brought to you by
        <a href="http://about.me/hardyferentschik">hardy</a>
        and
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
    </div>
  </body>
</html>
