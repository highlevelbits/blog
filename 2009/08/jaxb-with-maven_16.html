<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>high level bits - JAXB with Maven</title>
<link href="http://fonts.googleapis.com/css?family=Iceland%7CVolkhov" rel="stylesheet" type="text/css">
<link href="../../awesome/font-awesome-min.css" rel="stylesheet">
<link href="../../style.css" rel="stylesheet">
<link href="../../forms.css" rel="stylesheet">
<link rel="alternate" type="application/atom+xml" title="high level bits" href="../../atom.xml">
<!-- you don't need to keep this, but it's cool for stats! --><meta name="generator" content="nanoc 3.6.5">
<!-- google analytics --><script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1370334-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script><!-- end google analytics -->
</head>
<body>
    <div class="main">
      <div class="header">
        <div class="twitter-window">
          <a href="https://twitter.com/highlevelbits" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @highlevelbits</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
        <h1>h1ghlevelb1ts</h1>
      </div>
      <div class="menu">
        <a href="../../">home</a>
        ·
        <a href="../../archive.html">archive</a>
        ·
        <a href="http://about.me/hardyferentschik">hardy</a>
        ·
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
      <div class="content">
        <h2 class="article-header">
  JAXB with Maven
</h2>
<span class="byline">2009-08-16 by hardy</span>

  <span class="tags">
    
      <a class="one-tag" href="#java"><span class="icon-tag"></span>java</a>
    
      <a class="one-tag" href="#xml"><span class="icon-tag"></span>xml</a>
    
      <a class="one-tag" href="#maven"><span class="icon-tag"></span>maven</a>
    
  </span>

<p>Fredrik was recently blogging about "<a href="http://www.highlevelbits.com/2009/06/two-way-ssl-with-java.html">Two way SSL with Java</a>" and about his frustration about the lack of knowledge and documentation. This time I want to blog about another area of software development where frustration is running high - XML processing. On the surface things looks easy, but who does not remember the classpath problems around XML parsing in the early days (SAX vs XERCES vs DOM, etc). And who really fully understands the XSD syntax and is able to create a properly designed xsd? And documentation - let's just not talk about it!<br><br>But let's get to the actual problem. I wanted to use <a href="https://jaxb.dev.java.net/">JAXB</a> to write a parser for XML files matching a given xsd. Given that Sun introduced JAXB as official XML binding framework for Java it seems the obvious choice for the task. Unfortunately, another requirement was that the code would work under JDK 5 and 6. However, the JAXB API is only offical part of the JDK since version 6. To solve this problem a little trick is needed. Let's take it step by step using <a href="http://maven.apache.org/">Maven</a> as build system. First we have to include the <a href="http://mojo.codehaus.org/jaxb2-maven-plugin/">plugin</a> by adding the following to the <a href="http://maven.apache.org/pom.html">POM</a>:</p>
<pre class="brush: xml">
&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb2-maven-plugin&lt;/artifactId&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;xjc&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;configuration&gt;
        &lt;packageName&gt;org.hibernate.validation.xml&lt;/packageName&gt;
        &lt;outputDirectory&gt;${basedir}/target/generated-sources&lt;/outputDirectory&gt;
        &lt;extension&gt;true&lt;/extension&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre>
<p>The task of the plugin is to create the Java binding classes for the xsd. Per default the xsd file has to be placed into the directory <i>/src/main/xsd</i>. The configuration in the POM specifies the default package name for the generated classes and in which directory the classes have to be generated. The meaning of <i>extension </i>we will discuss a little later.<br><br>The setup so far will work fine with JDK 6, but in order to make it work for JDK 5 as well we have to use profiles. The idea is to add the required libraries which are missing in JDK 5 depending on the JDK version. This can be achieved by adding the following to the POM:</p>
<pre class="brush: xml">
&lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;jaxb&lt;/id&gt;
            &lt;activation&gt;
                &lt;jdk&gt;1.5&lt;/jdk&gt;
            &lt;/activation&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
                    &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
                    &lt;version&gt;2.1&lt;/version&gt;
                &lt;/dependency&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
                    &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;
                    &lt;version&gt;2.1.3&lt;/version&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/profile&gt;
&lt;/profiles&gt;
</pre>
<p>So far things were quite simple to figure out. The hard part is one more requirement I haven't mentioned yet. The parser should be tolerant against whitespaces. Some googling and I figured out that in JAXB this kind of things are done with adapters. In fact the <i>CollapsedStringAdapter</i> seems to be exactly what I want. The javadoc says:"This adapter removes leading and trailing whitespaces, then truncate any sequnce of tab, CR, LF, and SP by a single whitespace character '". Great, but how do I configure JAXB so that it automatically uses this adapter. Here the frustration really starts. The best a search for <i>CollapsedStringAdapter </i>results in is the javadoc for this class. Nothing about how to use it. Not in plain JAXB nor in conjunction with the maven plugin. Frustration started to mount again. To cut a long story short. It took many mailing list posts and a lot of try and error to figure it out. The outcome is that first of all you need the <i><extension>true</extension></i> bit in the plugin configuration. Next you have to create a file called <i>binding-customization.xjb </i>in <i>src/main/xjb</i>. The file has to contain the following:</p>
<pre class="brush: xml">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jxb:bindings version="1.0" xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"&gt;
    &lt;jxb:bindings schemaLocation="../xsd/validation-mapping-1.0.xsd" node="/xs:schema"&gt;
        &lt;jxb:globalBindings&gt;
            &lt;xjc:javaType name="java.lang.String" xmlType="xs:string"
                adapter="javax.xml.bind.annotation.adapters.CollapsedStringAdapter"/&gt;
        &lt;/jxb:globalBindings&gt;
    &lt;/jxb:bindings&gt;
&lt;/jxb:bindings&gt;
</pre>
<p>In the customization file a global binding gets defined for all <i>java.lang.String</i> types. It looks simple, but believe me it was damn hard to figure out. Hopefully this blog will save someone the painful hours I had.</p>
<p><br>My personal conclusion was that documetnation around XML related topics still sucks :(<br><br>--Hardy</p>
<div class="old-comments">
<h2>Old comments</h2>
<div class="one-old-comment">
<span class="comment-date">2009-08-17</span><span class="commenter-name">Fredrik Rubensson</span><div class="comment-body">Entirely according to my experience. JAXB sucks when it comes to doing the anything that is outside the simplest thing. It works fine for (un)marshalling but as soon as you want to do something else it is a misery.</div>
</div>
<div class="one-old-comment">
<span class="comment-date">2012-12-03</span><span class="commenter-name">lifestyle v35</span><div class="comment-body">Hi there, after reading this remaгkable paragraph i am too hapρу to shaгe mу know-how here with collеagues.</div>
</div>
<div class="one-old-comment">
<span class="comment-date">2012-12-25</span><span class="commenter-name">cipto junaedy</span><div class="comment-body">Hi, аlωays i usеd tο chеck wеb site poѕts here eаrlу
in thе daylіght, for the reаson that i liκe tο find out more and more.</div>
</div>
<div class="one-old-comment">
<span class="comment-date">2013-02-11</span><span class="commenter-name">PekMypeCheese</span><div class="comment-body">Reported in Full-Text Format at:    1997 U.S. App. LEXIS 11418. bankruptcy maryland  <a href="http://5FINGERSSHOES4U.COM">bankruptcy help orlando florida</a> discount bankruptcy florida </div>
</div>
</div>

<div class="dashed-top-border">
  <!-- disqus -->
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'highlevelbits'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  <!-- end disqus -->
</div>


  <div class="dashed-top-border">
    
      <h4><a name="java">Other articles tagged java</a></h4>
      <ul>
<li>
            <a href="../../2014/03/back-in-javaland.html">Back in Javaland</a> by fredrik on 2014-03-05
          </li>
        
          <li>
            <a href="../../2013/04/tdding_prime_detection.html">detecting prime numbers with Test Driven Development</a> by fredrik on 2013-04-23
          </li>
        
          <li>
            <a href="../../2011/02/jfokus-2011-day-2-wrap-up.html">JFokus 2011 Day 2 wrap-up</a> by hardy on 2011-02-16
          </li>
        
          <li>
            <a href="../../2011/02/jfokus-2011-day-1-wrap-up.html">JFokus 2011 Day 1 wrap-up</a> by hardy on 2011-02-16
          </li>
        
          <li>
            <a href="../../2010/11/where-are-my-sources.html">Where are my sources?</a> by hardy on 2010-11-04
          </li>
        
          <li>
            <a href="../../2010/03/snorcle-day.html">Snorcle day</a> by fredrik on 2010-03-19
          </li>
        
          <li>
            <a href="../../2010/01/jfokus-2010-day-2-summary.html">jfokus 2010 day 2 summary</a> by fredrik on 2010-01-29
          </li>
        
          <li>
            <a href="../../2010/01/jfokus-2010-day-1-summary.html">jfokus 2010 day 1 summary</a> by fredrik on 2010-01-27
          </li>
        
          <li>
            <a href="../10/give-my-scripting-support-back-please.html">Give my scripting support back, please ...</a> by hardy on 2009-10-15
          </li>
        
          <li>
            <a href="../10/1st-day-of-jaoo.html">1st day of JAOO</a> by fredrik on 2009-10-06
          </li>
        
          <li>
            <a href="../10/avoid-dock-icon-for-java-processes-on.html">Avoid Dock icon for Java processes on Mac OS</a> by hardy on 2009-10-05
          </li>
        
          <li>
            <a href="../10/java-programs-as-deamons-on-mac-os-x.html">Java programs as daemons on Mac OS X</a> by hardy on 2009-10-05
          </li>
        
          <li>
            <a href="../09/sed-to-rescue-or-how-to-migrate-from.html">sed to the rescue (or how to migrate from java.util.logging to org.slf4j)</a> by fredrik on 2009-09-16
          </li>
        
          <li>
            <a href="../09/my-macbook-pro-turns-soon-1-year-and-i.html">JDiskReport.</a> by hardy on 2009-09-07
          </li>
        
          <li>
            <a href="../06/two-way-ssl-with-java.html">Two way SSL with Java</a> by fredrik on 2009-06-02
          </li>
        
          <li>
            <a href="../02/introduction-to-ruby-on-rails-for-java.html">Introduction to Ruby on Rails for Java developers</a> by fredrik on 2009-02-22
          </li>
        
          <li>
            <a href="../02/jpa-not-so-good-after-all.html">JPA not so good after all?</a> by fredrik on 2009-02-05
          </li>
        
          <li>
            <a href="../01/jfokus-summary.html">jfokus summary</a> by fredrik on 2009-01-29
          </li>
        
          <li>
            <a href="../../2008/05/explicit-nullpointerexception.html">Explicit NullPointerException</a> by fredrik on 2008-05-20
          </li>
        
          <li>
            <a href="../../2008/03/no-need-to-code-just-annotate-it.html">No need to code - just annotate it...</a> by fredrik on 2008-03-25
          </li>
        
          <li>
            <a href="../../2008/02/little-curiosity-0.html">A little curiosity</a> by hardy on 2008-02-12
          </li>
        
          <li>
            <a href="../../2008/01/i-was-just-reading-latest-java.html">A whole new world</a> by hardy on 2008-01-16
          </li>
        
          <li>
            <a href="../../2007/04/krugle-next-google.html">Krugle the next Google?</a> by hardy on 2007-04-30
          </li>
        
          <li>
            <a href="../../2007/04/irony-of-application-servers.html">The irony of application servers</a> by fredrik on 2007-04-02
          </li>
        
          <li>
            <a href="../../2007/02/parallel-is-hard-word-to-spell-for.html">The bright future of parallel computing</a> by fredrik on 2007-02-22
          </li>
        
          <li>
            <a href="../../2007/02/mylar-solution-to-information-overload.html">Mylar - the solution to information overload</a> by hardy on 2007-02-20
          </li>
        
          <li>
            <a href="../../2007/02/there-is-hope-despite-everything.html">There is hope - despite everything</a> by fredrik on 2007-02-08
          </li>
        
      </ul>
<h4><a name="xml">Other articles tagged xml</a></h4>
      <ul>
<li>
            <a href="../../2008/09/list-apart-has-interesting-post-about.html">Web standards revisited</a> by fredrik on 2008-09-29
          </li>
        
      </ul>
<h4><a name="maven">Other articles tagged maven</a></h4>
      <ul>
<li>
            <a href="../../2010/02/buildr-overview.html">buildr overview</a> by fredrik on 2010-02-24
          </li>
        
          <li>
            <a href="../10/give-my-scripting-support-back-please.html">Give my scripting support back, please ...</a> by hardy on 2009-10-15
          </li>
        
          <li>
            <a href="../../2007/10/order-does-matter.html">Order does matter</a> by hardy on 2007-10-07
          </li>
        
      </ul>
</div>


      </div>
      <div class="footer">
        high level bits was brought to you by
        <a href="http://about.me/hardyferentschik">hardy</a>
        and
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
    </div>
  </body>
</html>
