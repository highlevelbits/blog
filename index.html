<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>high level bits - </title>
<link href="http://fonts.googleapis.com/css?family=Iceland%7CVolkhov" rel="stylesheet" type="text/css">
<link href="awesome/font-awesome-min.css" rel="stylesheet">
<link href="style.css" rel="stylesheet">
<link href="forms.css" rel="stylesheet">
<link rel="alternate" type="application/atom+xml" title="high level bits" href="atom.xml">
<!-- you don't need to keep this, but it's cool for stats! --><meta name="generator" content="nanoc 3.6.5">
<!-- google analytics --><script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1370334-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script><!-- end google analytics -->
</head>
<body>
    <div class="main">
      <div class="header">
        <div class="twitter-window">
          <a href="https://twitter.com/highlevelbits" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @highlevelbits</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
        <h1>h1ghlevelb1ts</h1>
      </div>
      <div class="menu">
        <a href="./">home</a>
        ·
        <a href="archive.html">archive</a>
        ·
        <a href="http://about.me/hardyferentschik">hardy</a>
        ·
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
      <div class="content">
        <div class="start-page">
  <div class="start-page-article">
    <div class="row">
      <h2 class="article-header">
        <a href="2013/11/composers.html">timeline of composers</a>
      </h2>
      <div class="byline">
        by
        fredrik
        on
        2013-11-13
      </div>
    </div>
    It is the season of requiems. At least here in Sweden we have lots of
<a href="https://en.wikipedia.org/wiki/Requiem">
  Requiem
</a>
concerts around
<a href="https://en.wikipedia.org/wiki/Halloween">
  Halloween
</a>
or Alla Helgons Afton as we used to call it before the americanization began. The triumphal entry of Halloween into Swedish culture may be the subject of another blog post. This blog post is about composers. We have been to two requiems this year. The ones by Duruflé and Brahms. I knew that Duruflé is kind of recent. The requiem is from the 40s. But I tried to put Brahms in the same time as Haydn which turned out to be totally and fundamentally wrong since Haydn was all dead before Brahms was born. So to make some sense out of the when of composers I decided to construct a timeline.
<script src="https://www.google.com/jsapi?autoload=%7B'modules':%5B%7B'name':'visualization','version':'1','packages':%5B'timeline'%5D%7D%5D%7D" type="text/javascript"></script>
<script>&#x000A;  google.setOnLoadCallback(drawChart);&#x000A;  &#x000A;  function drawChart() {&#x000A;    var container = document.getElementById('composers');&#x000A;  &#x000A;    var chart = new google.visualization.Timeline(container);&#x000A;  &#x000A;    var dataTable = new google.visualization.DataTable();&#x000A;  &#x000A;    dataTable.addColumn({ type: 'string', id: 'Composer' });&#x000A;    dataTable.addColumn({ type: 'date', id: 'Start' });&#x000A;    dataTable.addColumn({ type: 'date', id: 'End' });&#x000A;  &#x000A;    dataTable.addRows([&#x000A;      [ 'Händel', new Date(1685, 2, 23), new Date(1759, 4, 14) ],&#x000A;      [ 'Bach', new Date(1685, 3, 31), new Date(1750, 7, 28) ],&#x000A;      [ 'Haydn', new Date(1732, 3, 31), new Date(1809, 5, 31) ],&#x000A;      [ 'Mozart', new Date(1756, 1, 27), new Date(1791, 12, 5) ],&#x000A;      [ 'Beethoven', new Date(1770, 12, 17), new Date(1827, 3, 26) ],&#x000A;      [ 'Verdi', new Date(1813, 10, 10), new Date(1901, 1, 27) ],&#x000A;      [ 'Brahms', new Date(1833, 5, 7), new Date(1897, 4, 3) ],&#x000A;      [ 'Tchaikovsky', new Date(1840, 5, 7), new Date(1893, 11, 6) ],&#x000A;      [ 'Grieg', new Date(1843, 6, 15), new Date(1907, 9, 4) ],&#x000A;      [ 'Fauré', new Date(1845, 5, 12), new Date(1924, 11, 2) ],&#x000A;      [ 'Puccini', new Date(1858, 12, 22), new Date(1924, 11, 29) ],&#x000A;      [ 'Debussy', new Date(1862, 8, 22), new Date(1918, 3, 25) ],&#x000A;      [ 'Ravel', new Date(1875, 3, 7), new Date(1937, 12, 28) ],&#x000A;      [ 'Stravinsky', new Date(1882, 6, 17), new Date(1971, 4, 16) ],&#x000A;      [ 'Duruflé', new Date(1902, 1, 11), new Date(1986, 6, 16) ]&#x000A;    ]);&#x000A;  &#x000A;    chart.draw(dataTable);&#x000A;  }&#x000A;</script>
<div class="graph" id="composers" style="height: 700px; width: 100%; margin-top: 20px;"></div>
<p>
  I added randomly composers I came to think off and that I like or that are *important*. (Disclaimer: I don't really like Brahms...) For a while there was no living composer between Beethoven and Brahms but than I came to think of Verdi. He saves the continuity through the graph....
</p>
<p>
  There seems to be a cluster of composers born in the middle of the 19th century and active towards the late 19th century that I particularly like. A favourite for a long time in my youth - maybe because I play the piano - was Claude Debussy. The best piece of classical music I know right now is the Requiem by Gabriel Fauré. Also interesting is that this period is also the most interesting when it comes to visual arts. This is the age of impressionists with great french painters like Monet and Degas leading the way. My favourite Swedish art is also from this time. What was it that made this time so interesting when it comes to the arts? Yet another blog post about that mayhaps but I think the answer may be found in the borderlands between absolutism and relativism, authorithy and freedom etc. It was all falling apart - or in place depending on your view - at this time.
</p>
<p>
  For the nerd. You may look at the source to see what I did. It is a straightforward use of the
  <a href="https://developers.google.com/chart/interactive/docs/gallery/timeline">
    timeline graph
  </a>
  in the Google visualization API. I have been using some of the other graph types for statistics with my current client so it was an easy choice to put this together with the same technique. And the data was put in by MANUALLY reading wikipedia articles and transporting dates into the code. Will build integration with freebase or similar another time.....
</p>
    <center>
      ------
    </center>
    <div class="outro">
      <i>
        Even though this was the entire post you may want to leave a comment on the
        <a href="2013/11/composers.html">post page</a>
        .
      </i>
    </div>
  </div>
  <div class="start-page-article">
    <div class="row">
      <h2 class="article-header">
        <a href="2013/11/china.html">visions of china</a>
      </h2>
      <div class="byline">
        by
        fredrik
        on
        2013-11-03
      </div>
    </div>
    <p><img src="http://farm9.staticflickr.com/8465/8372395689_1a5a353bc8_b.jpg" alt=""></p>

<p>I like numbers. This is why I often sneak into <a href="http://www.flickr.com/photos/froderik/">my flickr account</a> and look at statistics. I have had an account for almost 8 years and there has beeen som 230000 views of my almost 8500 photos. And the more photos I put up - the more views I get. The other day I got interested in a peak on 30th of october with 1622 views and I found out that a picture (shown above) I took from the dragon tower in <a href="https://en.wikipedia.org/wiki/Harbin">Harbin</a> (China) last christmas had been used in <a href="http://www.theverge.com/2013/10/30/5042534/daan-roosegaarde-vacuum-looks-to-sweep-away-china-smog-in-beijing">a <strong>the verge</strong> post</a> about the chinese smog problem. Fun! I really liked the dreamy views from up the tower created by the cold -30 degrees celsius and the coal factories. Cold and cool….</p>

<p>Another shot I am happy with is this night time view of the main railway station in Harbin.</p>

<p><img src="http://farm9.staticflickr.com/8354/8373376294_4aac9d57ba_b.jpg" alt=""></p>

<p>Some <a href="http://www.flickr.com/search/?w=36307913@N00&amp;q=harbin">more photos</a> from our days in Harbin including many of ice sculptures.</p>

<p>From Harbin we got to Beijing by train. We only had two days there but still enough to get a good view of the forbidden palace and the wall. We had some luck with the weather the day when <a href="http://www.flickr.com/search/?w=36307913@N00&amp;q=great%20wall">we went out to the wall</a> - cold and sunny!</p>

<p><img src="http://farm9.staticflickr.com/8214/8441104536_a18c490d83_b.jpg" alt=""></p>

<p>Our visit to the forbidden palace was in very cloudy weather so no nice pictures from there. Night time in the old parts of Beijing on the other hand is something extra. It is rather dark - not much street lihtning but you still fell safe. Probably because there are much people around. The photo below is from a restaurant street where we had some nice hot pot!</p>

<p><img src="http://farm9.staticflickr.com/8193/8440607785_e90fb36635_b.jpg" alt=""></p>

<p>For more chinese goodness you can browse all <a href="http://www.flickr.com/search/?w=36307913@N00&amp;q=china">my photos from China</a>.</p>
    <center>
      ------
    </center>
    <div class="outro">
      <i>
        Even though this was the entire post you may want to leave a comment on the
        <a href="2013/11/china.html">post page</a>
        .
      </i>
    </div>
  </div>
  <div class="start-page-article">
    <div class="row">
      <h2 class="article-header">
        <a href="2013/10/multiple_fields_validation.html">multiple fields validation with javascript</a>
      </h2>
      <div class="byline">
        by
        fredrik
        on
        2013-10-15
      </div>
    </div>
    <p>
  I have encountered one particular kind of requirement several times now and made a couple of different implementations of it. This last implementation is generic and can be reused in several places. The task is to make a form submit button active only when all fields in a form validates. It helps the user to understand that they have entered something wrong without the roundtrip to a server. It should be combined with useful error messages next to the fields but I won't go in to that now.
</p>
<p>
  In the form below there are 3 different inputs with different validation requirements and the submit button only activates when all of them are validated. There need to be something in the text area and the date and time fields should be on the format dddd-dd-dd and dd:dd and only then will the button become activated.
</p>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script>&#x000A;  function buttonEnabling(buttonSelector, isEnabled){&#x000A;    if(isEnabled) {&#x000A;      $(buttonSelector).removeAttr("disabled");&#x000A;    } else {&#x000A;      $(buttonSelector).attr("disabled", "disabled")&#x000A;    }&#x000A;  }&#x000A;  &#x000A;  function validateFields(selectorsWithFunctions, buttonSelector) {&#x000A;    var isValid = true&#x000A;    for (var i = selectorsWithFunctions.length - 1; i >= 0; i--) {&#x000A;      var selector = selectorsWithFunctions[i][0];&#x000A;      var func = selectorsWithFunctions[i][1];&#x000A;  &#x000A;      if( !func(selector) ) {&#x000A;        isValid = false;&#x000A;        break;&#x000A;      }&#x000A;    };&#x000A;    buttonEnabling(buttonSelector, isValid);&#x000A;  }&#x000A;  &#x000A;  function validateTime(selector) {&#x000A;    var fieldValue = $(selector).val();&#x000A;    return /^\d\d:\d\d$/.test(fieldValue.trim());&#x000A;  }&#x000A;  &#x000A;  function validateDate(selector) {&#x000A;    var fieldValue = $(selector).val();&#x000A;    return /^\d\d\d\d-\d\d-\d\d$/.test(fieldValue.trim());&#x000A;  }&#x000A;  &#x000A;  function validatePresence(selector) {&#x000A;    var fieldValue = $(selector).val();&#x000A;    return fieldValue.length > 0&#x000A;  }&#x000A;  &#x000A;  function runFieldValidations() {&#x000A;    validators = [&#x000A;      ["#some-text", validatePresence],&#x000A;      ["#date", validateDate],&#x000A;      ["#time", validateTime]&#x000A;    ];&#x000A;    validateFields(validators, "#submit-button")&#x000A;  }&#x000A;  &#x000A;  $(document).ready(function(){&#x000A;    $("#some-text").keyup(runFieldValidations);&#x000A;    $("#date").keyup(runFieldValidations);&#x000A;    $("#time").keyup(runFieldValidations);&#x000A;    runFieldValidations();&#x000A;  });&#x000A;</script>
<p>
  </p>
<form>
    <div class="form-row">
      <div class="label">
        <label>
          Some mandatory text
        </label>
      </div>
      <textarea id="some-text"></textarea>
    </div>
    <div class="form-row">
      <div class="label">
        <label>
          A date (yyyy-mm-dd)
        </label>
      </div>
      <input id="date" type="text">
    </div>
    <div class="form-row">
      <div class="label">
        <label>
          A time (hh:mm)
        </label>
      </div>
      <input id="time" type="text">
    </div>
    <div class="form-row">
      <input disabled id="submit-button" type="submit">
    </div>
  </form>

<p>
  Lets go top down through the code that does this. I am using jquery in the example but it shouldn't be a problem doing the same thing with vanilla javascript or your framework of choice. First - set up event listeners on keyboard events triggered in our 3 widgets. (Widgets! Sound of the 90s!) For this the ready function of jquery is convenient:
</p>
<pre><code>$(document).ready(function(){
  $("#some-text").keyup(runFieldValidations);
  $("#date").keyup(runFieldValidations);
  $("#time").keyup(runFieldValidations);
  runFieldValidations();
}</code></pre>
<p>
  Three widgets means three event bindings to the function
  <code>runFieldValidations</code>
  that does the actual validations. Finally it is called once to make sure the button is in the correct state when entering the document. If it has been disabled to start with we can still end up with a bit of data entered by the browser from a previous session. The runFieldValidations function takes care of setting up the validation used for each widget.
</p>
<pre><code>  function runFieldValidations() {
    validators = [
      ["#some-text", validatePresence],
      ["#date", validateDate],
      ["#time", validateTime]
    ];
    validateFields(validators, "#submit-button")
  }</code></pre>
<p>
  It calls a generic function called
  <code>validateFields</code>
  that accepts an array of tuples each of which is a css selector (pointing to the widget we want to validate) and a function that should be called to validate it. As its second argument it accepts a css selector for the button that is to be (dis|en)abled. It loops over the tuples and calls the function to decide if the validation passes or not. As soon as something doesn't validate it breaks out of the loops and disables the button. In my first version button enabling was inline in the function but I decided that breaking it out would increase readability. The button enabling itself is as easy as setting or removing the attribute disabled.
</p>
<pre><code>function buttonEnabling(buttonSelector, isEnabled){
  if(isEnabled) {
    $(buttonSelector).removeAttr("disabled");
  } else {
    $(buttonSelector).attr("disabled", "disabled")
  }
}

function validateFields(selectorsWithFunctions, buttonSelector) {
  var isValid = true
  for (var i = selectorsWithFunctions.length - 1; i &gt;= 0; i--) {
    var selector = selectorsWithFunctions[i][0];
    var func = selectorsWithFunctions[i][1];

    if( !func(selector) ) {
      isValid = false;
      break;
    }
  };
  buttonEnabling(buttonSelector, isValid);
}</code></pre>
<p>
  This is the engine of the solution. Now the only thing left is to show the functions that does the actual validation. They accept a selector and does some easy checking on the value. In the date and time cases this is done with regular expressions. They look like this:
</p>
<pre><code>function validateTime(selector) {
  var fieldValue = $(selector).val();
  return /^\d\d:\d\d$/.test(fieldValue.trim());
}

function validateDate(selector) {
  var fieldValue = $(selector).val();
  return /^\d\d\d\d-\d\d-\d\d$/.test(fieldValue.trim());
}

function validatePresence(selector) {
  var fieldValue = $(selector).val();
  return fieldValue.length &gt; 0
}</code></pre>
<p>
  I am actually getting to like Javascript. It is rather easy to create small lightweight pieces of code. In this example we send around pointers to functions (a language feature that made this blog post possible). I think many script developers lack a bit in discipline and end up with high complexity and low readability. But this is clearly not the fault of javascript. As always - with higher levels of freedom comes a greater burden of responsibility.
</p>
    <center>
      ------
    </center>
    <div class="outro">
      <i>
        Even though this was the entire post you may want to leave a comment on the
        <a href="2013/10/multiple_fields_validation.html">post page</a>
        .
      </i>
    </div>
  </div>
</div>

      </div>
      <div class="footer">
        high level bits was brought to you by
        <a href="http://about.me/hardyferentschik">hardy</a>
        and
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
    </div>
  </body>
</html>
