<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>high level bits - How to process files with spaces using bash</title>
<link href="http://fonts.googleapis.com/css?family=Iceland%7CVolkhov" rel="stylesheet" type="text/css">
<link href="../../awesome/font-awesome-min.css" rel="stylesheet">
<link href="../../style.css" rel="stylesheet">
<link href="../../forms.css" rel="stylesheet">
<link rel="alternate" type="application/atom+xml" title="high level bits" href="../../atom.xml">
<!-- you don't need to keep this, but it's cool for stats! --><meta name="generator" content="nanoc 3.6.8">
<!-- google analytics --><script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-1370334-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script><!-- end google analytics -->
</head>
<body>
    <div class="main">
      <div class="header">
        <div class="twitter-window">
          <a href="https://twitter.com/highlevelbits" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @highlevelbits</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>
        <a href="../../">
          <h1>h1ghlevelb1ts</h1>
        </a>
      </div>
      <div class="menu">
        <a href="../../">home</a>
        ·
        <a href="../../archive.html">archive</a>
        ·
        <a href="http://about.me/hardyferentschik">hardy</a>
        ·
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
      <div class="content">
        <h2 class="article-header">
  How to process files with spaces using bash
</h2>
<div>
  <span class="byline">2010-03-08 by hardy</span>
  
    <span class="tags">
      
        <a class="one-tag" href="../../tags/bash.html" rel="tag"><span class="icon-tag"></span>bash</a>
      
    </span>
  
</div>
<div class="inner-content">
<p>The other day I wanted to rename a whole bunch of images with spaces and brackets in them. I had files of the form <i>filename1 (1).JPG</i>, <i>filename1 (2).JPG</i>, ..., <i>filename2 (1).JPG</i>, ...<br>In case you are wondering, these file came from a windows box where copies of files get saved in the format filename<space>(<index>).xyz. I know that from a OS point of view spaces in file names are no problem, but hell are spaces a pita if you have to process the files in a script. So what I wanted to do was to remove the space with a '_', replace the brackets and while on it lowercase the filenames (I really just don't like JPG, I want jpg). For these kind of problems I would normally try a for loop. Here is my first attempt:</index></space><br> </p>
<pre style="background-color: #eeeeee; border: 1px dashed rgb(153, 153, 153); color: black; font-family: Andale Mono,Lucida Console,Monaco,fixed,monospace; font-size: 12px; line-height: 14px; overflow: auto; padding: 5px; width: 100%;">
<code>for i in `ls -1 *.JPG`; do j=`echo $i | tr -d "[:blank:]" | tr "[:upper:]" "[:lower:]" | tr "(" "_" | tr -d ")"`; mv "$i" "$j"; done
</code></pre>
<br><p>The idea is to process each file name in a loop, transform the filename with a a set of <i>tr</i> calls and then do a final rename of the files using <i>mv</i>. <i>tr</i> takes its input from standard in and writes to standard out, hence the trick of first echoing the current value of the iteration, passing it through several <i>tr</i> calls and then assigning it to a temporary variable. Note the use of the character classes for the transformation via <i>tr</i>.<br><br>This one liner works fine for file names without spaces, but as soon as there are spaces in the file names you are getting into trouble. The default field separator of a for loop is the space character which means file names with spaces are causing two iterations of the loop. One solution to the problem is to set the $IFS variable prior to executing the for loop. The value of this variable determines the field separator. However, in this case you also have to remember to reset the variable afterward.<br><br>Another approach is to  use a completely different construct which you don't see so often. Let's use <i>find</i> together with a <i>while</i> loop.<br> </p>
<pre style="background-color: #eeeeee; border: 1px dashed rgb(153, 153, 153); color: black; font-family: Andale Mono,Lucida Console,Monaco,fixed,monospace; font-size: 12px; line-height: 14px; overflow: auto; padding: 5px; width: 100%;">
<code>find . -name "*.JPG" -print0 | while read -d $'\0' file; do j=`echo $file | tr -d "[:blank:]" | tr "[:upper:]" "[:lower:]" | tr "(" "_" | tr -d ")"`; mv "$file" $j; done
</code></pre>
<br><p>We use <i>find</i> together with the <i>-print0</i> option to print all file names into one line separated by a ASCII NUL character. In the loop we use <i>read </i>together with the <i>-d</i> option which determines the delimiter for <i>read</i>. The rest is the same as in the <i>for</i> loop solution.<br><br>Hope this helps some people, but maybe its just me who gets frustrated with spaces in file names ;-)<br><br>Enjoy,<br>Hardy</p>
<div class="old-comments">
<h2>Old comments</h2>
<div class="one-old-comment">
<span class="comment-date">2010-03-08</span><span class="commenter-name">http://abebedorespgondufo.blogs.sapo.pt/</span><div class="comment-body">Good.</div>
</div>
<div class="one-old-comment">
<span class="comment-date">2010-03-13</span><span class="commenter-name">Anonymous</span><div class="comment-body">Hi Hardy,<br><br>another great way to proccess filenames having spaces in name is the Unix-command <i>xargs</i>. When using it with options -l -i each filename can be processed in a very simple way.<br><br>Greating from Germany!<br><br>Thomas (a new toastmaster)</div>
</div>
<div class="one-old-comment">
<span class="comment-date">2010-03-14</span><span class="commenter-name">Hardy Ferentschik</span><div class="comment-body">ahh, nice one. I've never used any arguments to <i>xargs</i>. I use it a lot, but I never checked for any options. I guess its a good practice to read the manpages for the tools you are using.<br>P.S. Have fun with Toastmasters :)</div>
</div>
</div>
</div>

<div class="dashed-top-border">
  <!-- disqus -->
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'highlevelbits'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  <!-- end disqus -->
</div>

      </div>
      <div class="footer">
        high level bits was brought to you by
        <a href="http://about.me/hardyferentschik">hardy</a>
        and
        <a href="http://about.me/fredrik.rubensson">fredrik</a>
      </div>
    </div>
  </body>
</html>
